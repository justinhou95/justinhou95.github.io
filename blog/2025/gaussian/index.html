<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Gaussian coupling is Gaussian? | Songyan Hou </title> <meta name="author" content="Songyan Hou"> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://justinhou95.github.io/blog/2025/gaussian/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Songyan</span> Hou </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Gaussian coupling is Gaussian?</h1> <p class="post-meta"> Created in January 18, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote class="block-warning"> <p>If \(X,Y\) are Gaussian random variables. Is \((X,Y)\) Gaussian?</p> </blockquote> <p>If you google it, there are many counter-examples proving why this is NOT true in general. However, I find much less discussion on whether this could be true under some condition. So I decide to share my thoughts and also a proof from a optimal transport point of view.</p> <hr> <h3 id="counter-example">Counter example</h3> <p>We start with a well-known counter-example:</p> <p>Let \(X\) be a standard Gaussian, \(W\) be coin-flip i.e. a Bernoulli random variable taking values 1 and −1 with equal probability. If we define \(Y = W X\), then \(Y\) is still standard Gaussian by symmetric argument. However \(X+Y\) is not even Gaussian because \(X+Y = 0\) holds with probability \(1/2\).</p> <p>Another observation is that \(\mathbb{E}[XY] = 0\). So this is also an example when uncorrelated but dependent. Anyhow we have a counter example.</p> <h3 id="another-simple-example">Another simple example</h3> <p>Let \(X,Y\) standard Gaussian with correlation \(1\) i.e. \(\mathbb{E}[XY] = 1\). Then \(\mathbb{E}[(X-Y)^2] = 0\), so \(X=Y\). Therefore \((X,Y)\) is Gaussian!</p> <p>It is not difficult to generalize this to multi-dimension. Let \(X,Y\) be standard Gaussian on \(\mathbb{R}^d\) and assume \((X,Y)\) has covariance matrix: \(\begin{bmatrix}I&amp;P\\ P^\top&amp;I \end{bmatrix}.\) If \(P\) is orthogonal <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">1</a></sup>, i.e. \(PP^\top = I\), then similarly we get</p> \[\mathbb{E}[(X-PY)^2] = \mathrm{tr}\Big(\begin{bmatrix}I &amp; -P\end{bmatrix}\begin{bmatrix}I&amp;P\\ P^\top&amp;I \end{bmatrix}\begin{bmatrix}I \\ -P^\top\end{bmatrix}\Big) = 0.\] <p>So \(Y = P^\top X\) and \((X,Y)\) is Gaussian.</p> <h3 id="source-of-randomness">Source of randomness</h3> <p>The source of randomness is the key. The covariance structure is able to restrict the source of randomness. If the correlation is so high, there is no room for external randomness to enter. Then the only source of randomness is the marginal, which in our case a Gaussian randomness. As a result, the whole distribution is a linear transformation of the marginal, hence Gaussian.</p> <p>Our simple example assume marginal to be standard Gaussian, never the less, the proof generalize to general non-degenerate Gaussian marginals, by transforming marginals back to standard Gaussian.</p> <h3 id="non-degenerate-marginals">Non-degenerate marginals</h3> <p>We consider \(X \sim \mathcal{N}(a,A)\) and \(Y \sim \mathcal{N}(a,B)\) where \(A,B\) are positive semidefinite matrix. We represent the covariance matrix of \((X,Y)\) by \(\begin{bmatrix}A&amp;C\\ C^\top&amp;B \end{bmatrix}.\) Then by using the Cholesky decomposition \(A = LL^\top\) and \(B= MM^\top\), we transform \((X,Y)\) to \((L^{-1}X, M^{-1}Y)\) and simplify the problem to our simple example before:</p> \[\mathrm{Cov}\Big(\begin{bmatrix}L^{-1}X\\ M^{-1}Y\end{bmatrix}\Big) = \begin{bmatrix}I&amp;L^{-1}C(M^{-1})^{\top}\\ M^{-1}C^\top (L^{-1})^{\top}&amp;I \end{bmatrix}.\] <p>Therefore, if \(C = LPM^{\top}\) where \(P\) is orthogonal, \((X,Y)\) is Gaussian.</p> <blockquote class="block-tip"> <h4 id="theorem-1">Theorem 1</h4> <p>Let \(X \sim \mathcal{N}(a,A)\) and \(Y \sim \mathcal{N}(a,B)\) non-degenerate Gaussians. If \((X,Y)\) has covariance matrix of form: \(\begin{bmatrix}A&amp;C\\ C^\top&amp;B \end{bmatrix}.\) where \(C = LPM^{\top}\) and \(P\) is orthogonal, then \((X,Y)\) is Gaussian</p> </blockquote> <h3 id="optimal-transport-point-of-view">Optimal transport point of view</h3> <p>You might think how this related to optimal transport. If you have a hammer everything looks like a nail. Optimal transport is a huge topic with deep connections to many fields of mathematics. Here we only need the basic form:</p> \[\min_{X\sim \mu, Y\sim \nu}\mathbb{E}[|X-Y|^2].\] <p>Intuitively, it is finding the best way to couple \(X,Y\) given \(X\sim \mu\) and \(Y\sim \nu\). One of the most celebrated result in optimal transport is the Brenier theorem.</p> <blockquote class="block-tip"> <h4 id="breniers-theorem">Brenier’s theorem</h4> <p>Suppose \(\mu,\nu\) have second moments and \(\mu\) is absolutely continuous with respect to the Lebesgue measure. Then there exists a unique optimal coupling.</p> </blockquote> <p>Actually Brenier’s theorem is much more than this, but this is already enough for us now. In our setting, \(\mu\) and \(\nu\) are non-degenerate Gaussian, so the setting of Brenier’s theorem is fulfilled. By the existence part of Brenier’s theorem, there exists \((X,Y)\) which obtains the minimum. Again we denote the covariance matrix of \((X,Y)\) by \(\begin{bmatrix}A&amp;C\\ C^\top&amp;B \end{bmatrix}.\)</p> <p>Notice that the cost functional \(\mathbb{E}[|X-Y|^2]\) only depends on the mean and covariance of \((X,Y)\). So any \((X,Y)\) with the right mean and covariance would obtain the minimum. Of course, a Gaussian coupling with mean \(\begin{bmatrix}a \\ b \end{bmatrix}\) and covariance \(\begin{bmatrix}A&amp;C\\ C^\top&amp;B \end{bmatrix}\) is an optimal coupling.</p> <p>By the uniqueness part of Brenier’s theorem, there is only one optimal coupling. So there is a unique distribution of \((X,Y)\) with with mean \(\begin{bmatrix}a \\ b \end{bmatrix}\) and covariance \(\begin{bmatrix}A&amp;C\\ C^\top&amp;B \end{bmatrix}\) subjected to \(X\sim\mu\) and \(Y\sim\nu\), which is the Gaussian one above.</p> <p>From the discussion, we see if the covariance matrix of the coupling is a optimal coupling, then the coupling is Gaussian. In general, one may consider optimal transport problem with more general quadratic cost:</p> \[\min_{X\sim \mu, Y\sim \nu}\mathbb{E}[|X-\Lambda Y|^2].\] <p>If \(\Lambda\) is invertible, Brenier’s theorm still applies by a change of variable. Therefore, similarly one can prove Theorem 1 from an optimal transport approach, <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">2</a></sup>.</p> <h3 id="further-discussion">Further discussion</h3> <p>In this blog, we are in the setting where marginal are non-degenerate. It would also be interesting to see how this generalizes when marginals are degenerate.</p> <h4 id="references">References</h4> <ul> <li><a href="https://link.springer.com/book/10.1007/978-3-540-71050-9" rel="external nofollow noopener" target="_blank">Optimal Transport: Old and New</a></li> <li><a href="https://arxiv.org/abs/2412.18794" rel="external nofollow noopener" target="_blank">Entropic adapted Wasserstein distance on Gaussians</a></li> </ul> <hr> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:2" role="doc-endnote"> <p>\(P\) is a contraction matrix if and only if \(\begin{bmatrix}I&amp;P\\ P^\top&amp;I \end{bmatrix}\) is positive semidefinite. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:1" role="doc-endnote"> <p>One can also prove through the closed form <a href="https://djalil.chafai.net/blog/2010/04/30/wasserstein-distance-between-two-gaussians/" rel="external nofollow noopener" target="_blank">Wasserstein distance between two Gaussians</a> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p> </li> </ol> </div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Songyan Hou. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"About",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"post-when-marchenko-pastur-meets-bures-wasserstein",title:"When Marchenko\u2013Pastur meets Bures-Wasserstein",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/rmt/"}},{id:"post-gaussian-coupling-is-gaussian",title:"Gaussian coupling is Gaussian?",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/gaussian/"}},{id:"post-accidentally-commit-large-files-or-sensitive-data",title:"Accidentally commit large files or sensitive data",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/commit-large-files/"}},{id:"post-best-friends-building-python-package",title:"Best friends building Python package",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/build-project/"}},{id:"post-install-python-on-linux-without-sudo",title:"Install Python on Linux without Sudo",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/install-python/"}},{id:"news-i-am-thrilled-to-release-neuralhedge-https-github-com-justinhou95-neuralhedge-a-pytorch-based-package-for-deep-hedging-utility-maximization-portfolio-optimization-neuralhedge-is-fully-data-driven-lightweight-beginner-friendly-and-flexible-check-it-out",title:"\ud83c\udf89 I am thrilled to release [NeuralHedge](https://github.com/justinhou95/NeuralHedge) \ud83d\udcc8, a PyTorch-based package for deep...",description:"",section:"News"},{id:"news-excited-to-introduce-time-causal-vae-https-github-com-justinhou95-timecausalvae-for-robust-generating-financial-time-series",title:"\ud83d\ude80 Excited to introduce [Time-Causal VAE](https://github.com/justinhou95/TimeCausalVAE) \u23f1 for robust generating financial time-series!",description:"",section:"News"},{id:"news-excited-to-share-our-latest-work-pnot-python-nested-optimal-transport-https-github-com-justinhou95-nestedot-developed-together-with-ruben-bontorno-pnot-offers-ultra-fast-c-solvers-with-a-python-interface-for-solving-nested-adapted-optimal-transport-problems-in-particular-it-efficiently-computes-the-adapted-wasserstein-distance-combining-speed-and-precision-like-never-before-check-it-out-and-feel-free-to-contribute-or-give-feedback",title:"\ud83d\ude80 Excited to share our latest work: [PNOT: Python Nested Optimal Transport](https://github.com/justinhou95/NestedOT) \u2014...",description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%6A%75%73%74%69%6E%68%6F%75%39%35@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-researchgate",title:"ResearchGate",section:"Socials",handler:()=>{window.open("https://www.researchgate.net/profile/Songyan_Hou4/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/justinhou95","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/songyan-hou-223aa7153","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>