<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> When causal and classical Wasserstein are equivalent | Songyan Hou </title> <meta name="author" content="Songyan Hou"> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://justinhou95.github.io/blog/2025/equivalence/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Songyan</span> Hou </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">When causal and classical Wasserstein are equivalent</h1> <p class="post-meta"> Created in October 01, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>Notation</strong> We denote by \(\mathbf{S} \subset \mathbb{R}^{T\times T}\) the set of symmetric matrices, \(\mathbf{S}_+ \subset \mathbb{R}^{T\times T}\) the set of symmetric positive semi-definite matrices, \(\mathbf{L}\subset \mathbb{R}^{T\times T}\) the set of lower triangular matrices, \(\mathbf{L}_+\subset \mathbb{R}^{T\times T}\) the set of lower triangular matrices with non-negative diagonal, \(\mathbf{D}\subset \mathbb{R}^{T\times T}\) the set of diagonal matrices, \(\mathbf{O}\subset \mathbb{R}^{T\times T}\) the set of orthogonal matrices. We denote by \(\|\cdot \|_2\) the operator norm and \(\|\cdot\|_{\mathrm{F}}\) the Frobenius norm. The condition number of a matrix \(A\) is \(\kappa_2(A) = \| A^{-1}\|_2 \|A\|_2\).</p> <hr> <h3 id="adapted-wasserstein-distance">Adapted Wasserstein distance</h3> <p>The adapted Wasserstein distance is introduced as a strengthend version of classical Wasserstein distance by incorporating the temporal causal structure in order to guarantee robustness of stochastics optimization problem. Recall classcial Wasserstein distance \(\mathcal{W}_2\) is defined via</p> \[\mathcal{W}_2^2(\mu,\nu) = \inf_{(X,Y) \sim (\mu,\nu)} \mathbf{E}[|X - Y|^2],\] <p>while the adapted Wasserstein distance \(\mathcal{AW}_2\) (with nested representation) is defined via</p> \[\mathcal{AW}_2(\mu,\nu) = \inf_{(X,Y) \sim_{\rm bc} (\mu,\nu)} \mathbf{E}^{1/2}[|X - Y|^2],\] <p>where \(\sim_{\rm bc}\) imposes addition bicausal restriction on \((X,Y) \sim (\mu,\nu)\), so trivially \(\mathcal{W}_2\leq \mathcal{AW}_2\). This bicausal restriction enforces non-anticipativity in both directions and thus provide a natural and robust framework for stochastic optimization problems i.e. for many optimal values of stochastic optimization problem \(\mathcal{V}(\mu)\) we have</p> \[|\mathcal{V}(\mu) - \mathcal{V}(\nu)| \lesssim \mathcal{AW}_2(\mu,\nu)\] <p>but this does not hold for \(\mathcal{W}_2\).</p> <h3 id="gaussian-processes">Gaussian processes</h3> <p>For Gaussian processes, both \(\mathcal{W}_2\) and \(\mathcal{AW}_2\) have closed-form solutions. For simplicity we consider centered real-valued Gaussian process.</p> <p>Then \(\mathcal{W}_2\) is given by</p> \[\mathcal{W}_2^2(\mu,\nu) = \min_{O\in\mathbf{O}}\Vert A^{1/2} - B^{1/2}O\Vert_2^2 =: d_{\rm BW}^2(A,B),\] <p>and \(\mathcal{AW}_2\) is given by</p> \[\mathcal{AW}_2^2(\mu,\nu) = \min_{D\in\mathbf{D}\cap \mathbf{O}}\Vert L - MO \Vert_2^2 =: d_{\rm ABW}^2(L,M),\] <p>where \(A,B\) are covairance matrices of \(\mu,\nu\) and \(A = LL^\top\), \(B = MM^\top\) are Cholesky decomposition with non-negative diagonals.</p> <h3 id="when-causal-and-non-causal-distances-are-equivalent">When causal and non-causal distances are equivalent?</h3> <p>It is not difficult to construct examples when \(\mathcal{W}_2(\mu,\nu) \to 0\) while \(\mathcal{AW}_2(\mu,\nu)\) is large, so \(\mathcal{W}_2\) and \(\mathcal{AW}_2\) can not be equivalent in general (they induce different topology). However, in Gaussian case, it turns out that in a ball around regular Gaussian process, they are actually equivalent i.e. there exists \(C &gt; 0\) such that for all \(\mu, \nu\) in the ball</p> \[\mathcal{W}_2(\mu,\nu) \leq \mathcal{AW}_2(\mu,\nu) \leq C\cdot \mathcal{W}_2(\mu,\nu).\] <p>Let \(A \in \mathbf{S}_+\), and \(LL^\top = A\) be the Cholesky decomposition where \(L \in \mathbf{L}_+\). For a small perturbation \(\Delta A \in \mathbf{S}\), let \((L+\Delta L)(L + \Delta L)^\top = A + \Delta A\) be the Cholesky decomposition where \(\Delta L \in \mathbf{L}\). By the stability result of Cholesky decomposition; see [1], we know that if \(\|\Delta A\|_{\mathrm{F}} &lt; \frac{1}{2\| A^{-1}\|_2}\), then the Cholesky decomposition of \(A+\Delta A\) is unique and</p> \[\|\Delta L\|_F \leq (2 + \sqrt{2})\| A^{-1}\|_2\| A\|_2^{1/2}\|\Delta A\|_{\mathrm{F}}. \tag{1}\] <p>Now, denote \(B = A + \Delta A\) and \(M = L + \Delta L\). Note that for all \(O \in \mathbf{O}\), we have</p> \[\begin{aligned} \|A - B\|_\mathrm{F} &amp;\leq \| A^{\frac{1}{2}} A^{\frac{1}{2}} - A^{\frac{1}{2}}OB^{\frac{1}{2}} + A^{\frac{1}{2}}OB^{\frac{1}{2}} - B^{\frac{1}{2}}B^{\frac{1}{2}}\|_2 \\ &amp;\leq \| A^{\frac{1}{2}} \|_2 \| A^{\frac{1}{2}} - OB^{\frac{1}{2}}\|_\mathrm{F} + \| O B^{\frac{1}{2}} \|_2 \|A^{\frac{1}{2}} - B^{\frac{1}{2}} O^\top\|_\mathrm{F}\\ &amp; \leq (\| A^{\frac{1}{2}} \|_2 + \| B^{\frac{1}{2}} \|_2) \|A^{\frac{1}{2}} - B^{\frac{1}{2}} O^\top\|_\mathrm{F}. \end{aligned}\] <p>Taking the minimum over all \(O \in \mathbf{O}\) yields that</p> \[\|\Delta A\|_\mathrm{F} \leq (\| A^\frac{1}{2}\|_2 + \| B^\frac{1}{2}\|_2) d_{\rm BW}(A,B).\] <p>Plugging this estimate to (1), we obtain</p> \[d_{\rm ABW}(L,M) \leq (2 + \sqrt{2})\| A^{-1}\|_2\| A\|_2^{1/2}\| (\| A^\frac{1}{2}\|_2 + \| B^\frac{1}{2}\|_2) d_{\rm BW}(A,B).\] <p>Let \((A_t)_{t\in [0,1]}\) be a geodesic on \((\mathbf{S}_{+},d_{\rm BW})\) connecting \(A\) to \(B\), then</p> \[d_{\rm ABW}(L,M) \leq \left(\int_0^1 2(2 + \sqrt{2})\| A_t^{-1}\|_2\| A_t\|_2^{1/2}\| \| A_t^\frac{1}{2}\|_2 dt\right)d_{\rm BW}(A,B).\] <p>Therefore, on a geodesically convex set where \(\| A^{-1}\|_2\| A\|_2^{1/2}\| \| A^\frac{1}{2}\|_2\) upper-bounded, the following equivalence holds:</p> \[d_{\rm ABW}(L,M) \leq C\cdot d_{\rm BW}(A,B).\] <h3 id="discussion">Discussion</h3> <p>The take home message is: if you’re working on distributional robustness around a regular Gaussian processes, causal and non-causal distances are equivalent, so just pick one you like.</p> <p>A natural next question is whether this could be extended to more general cases. Extending to multi-dimensional Gaussian processes case I believe is quite manageable. Extending this to general ``regular” stochastic processes is a bit more subtle. To me, there are at least two challenging questions to answer. First, what is the right characterization of regularity? Second, how can one estimate distances without the privilege closed-form solutions? If you are also interested in this and have an idea, feel free to reach me out. If you worry that this would make the study of causal distance useless, also reach me out and I am also happy to chat about that.</p> <hr> <h3 id="reference">Reference</h3> <p>[1] X-W Chang and Damien Stehl´e. “Rigorous perturbation bounds of some matrix factorizations”. SIAM journal on matrix analysis and applications 31.5 (2010), pp. 2841–2859.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Songyan Hou. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"About",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"post-when-causal-and-classical-wasserstein-are-equivalent",title:"When causal and classical Wasserstein are equivalent",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/equivalence/"}},{id:"post-when-mar\u010denko-pastur-meets-bures-wasserstein",title:"When Mar\u010denko-Pastur meets Bures-Wasserstein",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/rmt/"}},{id:"post-gaussian-coupling-is-gaussian",title:"Gaussian coupling is Gaussian?",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/gaussian/"}},{id:"post-accidentally-commit-large-files-or-sensitive-data",title:"Accidentally commit large files or sensitive data",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/commit-large-files/"}},{id:"post-best-friends-building-python-package",title:"Best friends building Python package",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/build-project/"}},{id:"post-install-python-on-linux-without-sudo",title:"Install Python on Linux without Sudo",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/install-python/"}},{id:"news-i-am-thrilled-to-release-neuralhedge-https-github-com-justinhou95-neuralhedge-a-pytorch-based-package-for-deep-hedging-utility-maximization-portfolio-optimization-neuralhedge-is-fully-data-driven-lightweight-beginner-friendly-and-flexible-check-it-out",title:"\ud83c\udf89 I am thrilled to release [NeuralHedge](https://github.com/justinhou95/NeuralHedge) \ud83d\udcc8, a PyTorch-based package for deep...",description:"",section:"News"},{id:"news-excited-to-introduce-time-causal-vae-https-github-com-justinhou95-timecausalvae-for-robust-generating-financial-time-series",title:"\ud83d\ude80 Excited to introduce [Time-Causal VAE](https://github.com/justinhou95/TimeCausalVAE) \u23f1 for robust generating financial time-series!",description:"",section:"News"},{id:"news-excited-to-share-our-latest-work-pnot-python-nested-optimal-transport-https-github-com-justinhou95-nestedot-developed-together-with-ruben-bontorno-pnot-offers-ultra-fast-c-solvers-with-a-python-interface-for-solving-nested-adapted-optimal-transport-problems-in-particular-it-efficiently-computes-the-adapted-wasserstein-distance-combining-speed-and-precision-like-never-before-check-it-out-and-feel-free-to-contribute-or-give-feedback",title:"\ud83d\ude80 Excited to share our latest work: [PNOT: Python Nested Optimal Transport](https://github.com/justinhou95/NestedOT) \u2014...",description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%6A%75%73%74%69%6E%68%6F%75%39%35@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-researchgate",title:"ResearchGate",section:"Socials",handler:()=>{window.open("https://www.researchgate.net/profile/Songyan_Hou4/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/justinhou95","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/songyan-hou-223aa7153","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>